<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EyeStyle</title>
    

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
</head>

<body>
    <div id="invoice" class="container mt-5 mb-5">

        <div class="row d-flex justify-content-center">

            <div class="col-md-8">

                <div class="card">


                        <div class="text-left logo p-2 px-5">

                            <!-- <img src="https://i.imgur.com/2zDU056.png" width="50"> -->
                            <h3><strong>EyeStyle</strong></h3>

                            <button id="downloadPDF" class="btn btn-primary">Download Invoice</button>
                            

                        </div>

                        <div class="invoice p-5">

                            <h5>Your order Confirmed!</h5>

                            <span class="font-weight-bold d-block mt-4">Hello, <%= userAddress.name %></span>
                            <span>You order has been confirmed and will be shipped in next two days!</span>

                            <div class="payment border-top mt-3 mb-3 border-bottom table-responsive">

                                <table class="table table-borderless">
                                    
                                    <tbody>
                                        <tr>
                                            <td>
                                                <div class="py-2">

                                                    <span class="d-block text-muted">Order Date</span>
                                                <span><%= orderData.createdAt.toLocaleDateString() %></span>
                                                    
                                                </div>
                                            </td>

                                            <td>
                                                <div class="py-2">

                                                    <span class="d-block text-muted">Order No</span>
                                                <span><%= orderData._id %></span>
                                                    
                                                </div>
                                            </td>

                                            <td>
                                                <div class="py-2">

                                                    <span class="d-block text-muted">Payment</span>
                                               <span><%= orderData.payment_way %></span>
                                                    
                                                </div>
                                            </td>

                                            <td>
                                                <div class="py-2">

                                                    <span class="d-block text-muted">Shiping Address</span>
                                              
                                                <span><%= userAddress.name %></span>
                                                <span><%= userAddress.phone %></span>
                                                <span><%= userAddress.add %></span>
                                                <span><%= userAddress.district %></span>
                                                <span><%= userAddress.state %></span>
                                                    
                                                </div>
                                            </td>
                                        </tr>
                                    </tbody>

                                </table>




                                
                            </div>




                                <div class="product border-bottom table-responsive">

                                    <table class="table table-borderless">

                                    <tbody>
                                        <% orderData.item.forEach((item) => { %>
                                        <tr>
                                            <td width="20%">
                                            
                                            <img src="/<%= item.product.image[0] %>" width="90">

                                        </td>
                                    
                                        <td width="60%">
                                            <span class="font-weight-bold"><%= item.product.pname %></span>
                                            <div class="product-qty">
                                                <span class="d-block">Quantity: <%= item.quantity %></span>
                                                
                                                
                                            </div>
                                        </td>
                                        <td width="20%">
                                            <div class="text-right">
                                                <span class="font-weight-bold">₹ <%= item.price %></span>
                                            </div>
                                        </td>
                                        </tr>
                                        <% }) %>
                                    </tbody> 
                                        
                                    </table>
                                    


                                </div>



                                <div class="row d-flex justify-content-end">

                                    <div class="col-md-5">

                                        <table class="table table-borderless">

                                            <tbody class="totals">

                                                <tr>
                                                    <!-- <td>
                                                        <div class="text-left">

                                                            <span class="text-muted">Subtotal</span>
                                                            
                                                        </div>
                                                    </td>
                                                    <td>
                                                        <div class="text-right">
                                                            <span>₹  </span>
                                                        </div>
                                                    </td> -->
                                                </tr>


                                                 <tr>
                                                    <!-- <td>
                                                        <div class="text-left">

                                                            <span class="text-muted">Discount</span>
                                                            
                                                        </div>
                                                    </td>
                                                    <td>
                                                        <div class="text-right">
                                                            <span class="text-success">₹ </span>
                                                        </div>
                                                    </td> -->
                                                </tr>


                                                 <tr class="border-top border-bottom">
                                                    <td>
                                                        <div class="text-left">

                                                            <span class="font-weight-bold">Subtotal</span>
                                                            
                                                        </div>
                                                    </td>
                                                    <td>
                                                        <div class="text-right">
                                                            <span class="font-weight-bold">₹ <%= orderData.total %></span>
                                                        </div>
                                                    </td>
                                                </tr>
                                                
                                            </tbody>
                                            
                                        </table>
                                        
                                    </div>
                                    


                                </div>


                                
                                <p class="font-weight-bold mb-0">Thanks for shopping with us!</p>
                                <span>EyeStyle Team</span>



                            

                        </div>


                        <div class="d-flex justify-content-between footer p-3">

                            <span>Need Help? visit our <a href="#"> help center</a></span>
                            
                            
                        </div>



            
        </div>
                
            </div>
            
        </div>
        
    </div>

    <style>

        @import url('https://fonts.googleapis.com/css2?family=Montserrat&display=swap');

        body{
            background-color: #ffe8d2;
            font-family: 'Montserrat', sans-serif
        }

        .card{
            border:none
        }

        .logo{
            background-color: #eeeeeea8
        }

        .totals tr td{
            font-size: 13px
        }

        .footer{
            background-color: #eeeeeea8
        }

        .footer span{
            font-size: 12px
        }

        .product-qty span{
            font-size: 12px;color: #dedbdb
        }
    </style>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.min.js"></script>
<!-- PDF AND EXCEL -->

<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>

<script>
        const button = document.getElementById('downloadPDF');

        function generatePDF() {
        
            const element = document.getElementById('invoice');
        
            html2pdf().from(element).save();
        }

        button.addEventListener('click', generatePDF);

        function export_data() {
            let data = document.getElementById('invoice');
            var fp = XLSX.utils.table_to_book(data, { sheet: 'invoice' });
            XLSX.write(fp, {
                bookType: 'xlsx',
                type: 'base64'
            });
            XLSX.writeFile(fp, 'test.xlsx');
        }
</script>

</body>
</html>